#!/usr/bin/env python

import sys
import json
import remus.db


if __name__ == "__main__":
    dbi = remus.db.connect(sys.argv[1])
    cmd = sys.argv[2]

    if cmd == 'ls':
        if len(sys.argv) > 3:
            inst = sys.argv[3]
            for table in dbi.listTables(inst):
                print table
        else:
            for inst in dbi.listInstances():
                print inst
    if cmd == 'keys':
        t = remus.db.TableRef(sys.argv[3])
        for key in dbi.listKeys(t):
            print key
    if cmd == 'info':
        t = remus.db.TableRef(sts.argv[3])
        print json.dumps(dbi.getInfo(t))
